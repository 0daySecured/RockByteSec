---
layout: splash
title: Stealing login credentials using Reflected XSS
header:
  overlay_color: "#000000"
excerpt: ""
---

Back to September 2019. This was my first bounty worth $100. I got really exited at the moment the email notification popped-up. Read this write-up to know how I found that vulnerability.


Letâ€™s name the website as `www.example.com`. I understood that how the web application works. After understanding, I logged out of the application and tried to visit the paths that are only available to logged-in users. As soon as I hit the first path `/settings` from my list, I was redirected to `/login?redirect_to=%2fsettings`.


I immediately thought of trying Open-redirect attack and I was successful to get a redirect to `https://google.com/` by visiting `https://www.example.com/login?redirect_to=https%3A%2f%2fgoogle.com%2f` and logging into `www.example.com`

<br>
Then, I tried to get XSS alert popup by visiting `https://www.example.com/login?redirect_to=javascript%3Aalert(1)` and got that alert popup.

<br>
Then I thought why not try stealing login credentials. So I went for that. Carefully crafted a payload and embedded it after URL encoding it into the parameter and visited the link:

#### Payload:
```
javascript:alert(document.getElementById(%22email%22).value)%3B%20alert(document.getElementById(%22password%22).value)
```

#### URL:
```
https://www.example.com/login?redirect_to=javascript%3Aalert%28document%2EgetElementById%28%2522email%2522%29%2Evalue%29%253B%2520alert%28document%2EgetElementById%28%2522password%2522%29%2Evalue%29
```

An Alert popped up for both email and password of the victim.

In layman terms, the attack is like this: An attacker sends email to the vicitm including above URL in order to send credentials to attacker's server and the victim clicks the link and that's it.